# UncertaintyCat üò∫ | AI-driven UQ


[![Streamlit App](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://uncertainty.streamlit.app/)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Python 3.10+](https://img.shields.io/badge/Python-3.10%2B-blue.svg)](https://www.python.org/downloads/release/python-3100/)
[![CI](https://github.com/MLegkovskis/UncertaintyCat/actions/workflows/ci.yml/badge.svg)](https://github.com/MLegkovskis/UncertaintyCat/actions/workflows/ci.yml)


Welcome to **UncertaintyCat**‚Äîan interactive application designed to make **Uncertainty Quantification (UQ)** and **Sensitivity Analysis** accessible to everyone! Whether you're an engineer, data scientist, or researcher, UncertaintyCat simplifies complex UQ techniques, providing AI-driven insights and a user-friendly interface.

[**üåê Try the App Now!**](https://uncertainty.streamlit.app/)

---

## üéØ Table of Contents

- [Features](#features)
- [Getting Started](#getting-started)
  - [Prerequisites](#prerequisites)
  - [Installation](#installation)
- [Usage](#usage)
  - [Running the App](#running-the-app)
  - [Defining Your Model](#defining-your-model)
  - [Supported Distributions](#supported-distributions)
  - [Examples](#examples)
  - [Dimensionality Reduction](#dimensionality-reduction)
  - [Surrogate Modeling with Polynomial Chaos Expansion](#surrogate-modeling-with-polynomial-chaos-expansion)
- [Application Modules](#application-modules)
  - [1. Model Understanding](#1-model-understanding)
  - [2. Exploratory Data Analysis](#2-exploratory-data-analysis)
  - [3. Expectation Convergence Analysis](#3-expectation-convergence-analysis)
  - [4. Sobol Sensitivity Analysis](#4-sobol-sensitivity-analysis)
  - [5. Morris Sensitivity Analysis](#5-morris-sensitivity-analysis)
  - [6. Taylor Analysis](#6-taylor-analysis)
  - [7. Correlation Analysis](#7-correlation-analysis)
  - [8. HSIC Analysis](#8-hsic-analysis)
  - [9. SHAP Analysis](#9-shap-analysis)
- [Contributing](#contributing)
- [License](#license)
- [Acknowledgments](#acknowledgments)

---

## üåü Features

- **User-Friendly Interface:** An intuitive Streamlit app that guides you through the UQ process.
- **Model Flexibility:** Define custom models or choose from predefined examples across various industries.
- **Comprehensive Analyses:**
  - Monte Carlo Simulations
  - Sensitivity Analyses (Sobol, Morris, Taylor)
  - Correlation Analysis
  - HSIC (Hilbert-Schmidt Independence Criterion)
  - SHAP Analysis for ML Interpretability
- **Dimensionality Reduction:** Simplify models by identifying non-influential variables using Morris Sensitivity Analysis.
- **Surrogate Modeling:** Generate Polynomial Chaos Expansion (PCE) surrogates for computational efficiency.
- **AI-Powered Insights:** Receive interpretations and explanations generated by advanced language models.
- **Extensible:** Modular codebase designed for easy customization and extension.

---

## üöÄ Getting Started

### Prerequisites

- **Python 3.8 or higher**
- **pip** package manager

### Installation

1. **Clone the Repository**

   ```bash
   git clone https://github.com/MLegkovskis/LITUQ
   cd LITUQ
   ```

2. **Create a Virtual Environment (Optional but Recommended)**

   ```bash
   python3 -m venv venv
   source venv/bin/activate  # On Windows use: venv\Scripts\activate
   ```

3. **Install Required Packages**

   ```bash
   pip install -r requirements.txt
   ```

---

## üìñ Usage

### Running the App

To start the application, run:

```bash
streamlit run app.py
```

This will launch the app in your default web browser at `http://localhost:8501`.

### Defining Your Model

#### **1. Model Function**

- **Function Name:** Your model must be defined as a Python function named `function_of_interest(X)`.
- **Input Parameter:** `X`, a NumPy array representing the input variables.
- **Return Value:** A list containing a single output quantity of interest.

**Example:**

```python
import numpy as np

def function_of_interest(X):
    x1, x2 = X
    Y = x1 ** 2 + np.sin(x2)
    return [Y]
```

#### **2. Problem Definition**

Create a dictionary named `problem` specifying:

- `'num_vars'`: Number of input variables.
- `'names'`: List of variable names.
- `'distributions'`: List of distribution dictionaries for each variable.

**Example:**

```python
problem = {
    'num_vars': 2,
    'names': ['x1', 'x2'],
    'distributions': [
        {'type': 'Uniform', 'params': [0, 1]},
        {'type': 'Normal', 'params': [0, 1]}
    ]
}
```

#### **3. Model Assignment**

Assign your function to the variable `model`:

```python
model = function_of_interest
```

### Supported Distributions

UncertaintyCat supports the following distributions:

1. **Uniform**

   ```python
   {'type': 'Uniform', 'params': [lower_bound, upper_bound]}
   ```

2. **Normal**

   ```python
   {'type': 'Normal', 'params': [mean, standard_deviation]}
   ```

3. **LogNormalMuSigma**

   ```python
   {'type': 'LogNormalMuSigma', 'params': [mu, sigma, gamma]}
   ```

   - `mu`: Mean of the LogNormal variable.
   - `sigma`: Standard deviation.
   - `gamma`: Location parameter (default is `0` if not specified).

4. **LogNormal**

   ```python
   {'type': 'LogNormal', 'params': [mu_log, sigma_log, gamma]}
   ```

5. **Beta**

   ```python
   {'type': 'Beta', 'params': [alpha, beta, lower_bound, upper_bound]}
   ```

6. **Gumbel**

   ```python
   {'type': 'Gumbel', 'params': [beta_param, gamma_param]}
   ```

7. **Triangular**

   ```python
   {'type': 'Triangular', 'params': [a, mode, b]}
   ```

### Examples

The `examples/` directory contains a variety of predefined models:

#### **1. Beam Deflection Model**

**Industry:** Structural Engineering

```python
def function_of_interest(X):
    E, F, L, I = X
    Y = F * L**3 / (3 * E * I)
    return [Y]

problem = {
    'num_vars': 4,
    'names': ['E', 'F', 'L', 'I'],
    'distributions': [
        {'type': 'Beta', 'params': [0.9, 3.1, 2.8e7, 4.8e7]},        # E
        {'type': 'LogNormalMuSigma', 'params': [3.0e4, 9.0e3, 0]},   # F
        {'type': 'Uniform', 'params': [250., 260.]},                 # L
        {'type': 'Beta', 'params': [2.5, 4, 310., 450.]}             # I
    ]
}

model = function_of_interest
```

#### **2. Ishigami Function**

**Industry:** Sensitivity Analysis Benchmark

```python
import numpy as np

def function_of_interest(X):
    x1, x2, x3 = X
    Y = np.sin(x1) + 7 * np.sin(x2) ** 2 + 0.1 * x3 ** 4 * np.sin(x1)
    return [Y]

problem = {
    'num_vars': 3,
    'names': ['x1', 'x2', 'x3'],
    'distributions': [
        {'type': 'Uniform', 'params': [-np.pi, np.pi]},  # x1
        {'type': 'Uniform', 'params': [-np.pi, np.pi]},  # x2
        {'type': 'Uniform', 'params': [-np.pi, np.pi]}   # x3
    ]
}

model = function_of_interest
```

*More examples are available in the `examples/` directory.*

### Dimensionality Reduction

**Purpose:** Identify non-influential variables to simplify your model.

**How to Use:**

- Navigate to the **"Dimensionality Reduction"** page in the app.
- Run the **Morris Sensitivity Analysis** to obtain a reduced set of input variables.
- Choose variables to fix and generate the reduced model.
- Copy the reduced model code back into the main app's code editor.

### Surrogate Modeling with Polynomial Chaos Expansion

**Purpose:** Create a surrogate model to reduce computational load for complex models.

**How to Use:**

- Go to the **"PCE Surrogate Model"** page in the app.
- Adjust PCE parameters as needed to improve surrogate accuracy.
- Generate the PCE surrogate model.
- Copy the generated surrogate model code into the main app's code editor.
- Use the surrogate model for faster analyses.

---

## üõ†Ô∏è Application Modules

UncertaintyCat includes several modules that perform different analyses:

### 1. Model Understanding

- **Purpose:** Provides a summary of the model, inputs, and outputs.
- **Features:**
  - Mathematical interpretation of the model using LaTeX equations.
  - Explanation of input variables and their distributions.

### 2. Exploratory Data Analysis

- **Purpose:** Analyzes the generated data from Monte Carlo simulations.
- **Features:**
  - Histograms and density plots.
  - Descriptive statistics.

### 3. Expectation Convergence Analysis

- **Purpose:** Examines how the expected value converges with increasing sample size.
- **Features:**
  - Convergence plots.
  - Estimation of required sample size for desired accuracy.

### 4. Sobol Sensitivity Analysis

- **Purpose:** Quantifies the contribution of each input variable to the output variance.
- **Features:**
  - First-order, second-order, and total Sobol indices.
  - Sensitivity rankings.
  - Radial plots for visualizing interactions.

### 5. Morris Sensitivity Analysis

- **Purpose:** Identifies input variables that have significant effects on the output.
- **Features:**
  - Elementary effect measures.
  - Input factors classification.
  - Used for Dimensionality Reduction.

### 6. Taylor Analysis

- **Purpose:** Uses Taylor series expansion to approximate the model output.
- **Features:**
  - Importance factors based on model derivatives.
  - Pie charts showing variable contributions.

### 7. Correlation Analysis

- **Purpose:** Studies the correlation between inputs and outputs.
- **Features:**
  - Pearson and Spearman correlation coefficients.
  - Correlation matrices and bar charts.

### 8. HSIC Analysis

- **Purpose:** Measures statistical dependence using the Hilbert-Schmidt Independence Criterion.
- **Features:**
  - HSIC and R2-HSIC indices.
  - p-values for statistical significance.
  - Bar charts for visualizing dependencies.

### 9. SHAP Analysis

- **Purpose:** Explains model predictions using SHAP (SHapley Additive exPlanations) values.
- **Features:**
  - SHAP value plots.
  - Feature importance rankings.
  - Dependence plots for top features.

---

## ü§ù Contributing

Contributions are welcome! If you'd like to contribute, please:

1. **Fork the Repository**

   ```bash
   git clone https://github.com/your_username/UncertaintyCat.git
   ```

2. **Create a Feature Branch**

   ```bash
   git checkout -b feature/YourFeature
   ```

3. **Make Your Changes and Commit Them**

   ```bash
   git commit -m "Add new feature"
   ```

4. **Push to the Branch**

   ```bash
   git push origin feature/YourFeature
   ```

5. **Open a Pull Request into the main branch**

---

Feel free to explore, contribute, and share your thoughts. Let's make Uncertainty Quantification accessible to all!

